<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>USB IR HID Device: usbdrv/usbdrvasm128.inc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>usbdrv/usbdrvasm128.inc File Reference</h1>
<p><a href="usbdrvasm128_8inc_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="usbdrvasm128_8inc.html#ac2f992b6aac204db01b43b4fd43463b3">printCmdBuffer</a> ($thisBit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="usbdrvasm128_8inc.html#aa20c6421372db9ad7677dd98edb28bc4">printBit</a> ($isAfterSet, $bitNum)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="usbdrvasm128_8inc.html#a54b8fd7c4098cdf9f73bd9e5f27d41c8">$bitStartCycles</a> = array(1, 9, 17, 26, 34, 42, 51, 59)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa20c6421372db9ad7677dd98edb28bc4"></a><!-- doxytag: member="usbdrvasm128.inc::printBit" ref="aa20c6421372db9ad7677dd98edb28bc4" args="($isAfterSet, $bitNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">printBit </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>isAfterSet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>bitNum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="usbdrvasm128_8inc_source.html#l00686">686</a> of file <a class="el" href="usbdrvasm128_8inc_source.html">usbdrvasm128.inc</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00687"></a>00687 {
<a name="l00688"></a>00688     ob_start();
<a name="l00689"></a>00689     <span class="keywordflow">if</span>($isAfterSet){
<a name="l00690"></a>00690 ?&gt;
<a name="l00691"></a>00691     ifioclr <a class="code" href="usbdrv_8h.html#a85296740a603c928460d39ef9be869a4">USBIN</a>, <a class="code" href="usbdrv_8h.html#ad84a1c137f273772bcba266e0a671d33">USBMINUS</a>     ;[00] &lt;--- sample
<a name="l00692"></a>00692     rjmp    bit#IsClr           ;[01]
<a name="l00693"></a>00693     andi    shift, ~(7 &lt;&lt; #)    ;[02]
<a name="l00694"></a>00694     breq    unstuff#s           ;[03]
<a name="l00695"></a>00695     in      phase, USBIN        ;[04] &lt;- phase
<a name="l00696"></a>00696     rjmp    bit@AfterSet        ;[05]
<a name="l00697"></a>00697 unstuff#s:
<a name="l00698"></a>00698     in      phase, USBIN        ;[05] &lt;- phase (one cycle too late)
<a name="l00699"></a>00699     andi    fix, ~(1 &lt;&lt; #)      ;[06]
<a name="l00700"></a>00700     <a class="code" href="usbportability_8h.html#a62df5117c12fbb897e5d6956620d794b">nop2</a>                        ;[-1]
<a name="l00701"></a>00701     <a class="code" href="usbportability_8h.html#a62df5117c12fbb897e5d6956620d794b">nop2</a>                        ;[01]
<a name="l00702"></a>00702 bit#IsClr:
<a name="l00703"></a>00703     ifrset  phase, USBMINUS     ;[03] check phase only <span class="keywordflow">if</span> D- changed
<a name="l00704"></a>00704     lpm                         ;[04]
<a name="l00705"></a>00705     in      phase, USBIN        ;[05] &lt;- phase (one cycle too late)
<a name="l00706"></a>00706     ori     shift, 1 &lt;&lt; #       ;[06]
<a name="l00707"></a>00707 &lt;?php
<a name="l00708"></a>00708     }<span class="keywordflow">else</span>{
<a name="l00709"></a>00709 ?&gt;
<a name="l00710"></a>00710     ifioset <a class="code" href="usbdrv_8h.html#a85296740a603c928460d39ef9be869a4">USBIN</a>, <a class="code" href="usbdrv_8h.html#ad84a1c137f273772bcba266e0a671d33">USBMINUS</a>     ;[00] &lt;--- sample
<a name="l00711"></a>00711     rjmp    bit#IsSet           ;[01]
<a name="l00712"></a>00712     andi    shift, ~(7 &lt;&lt; #)    ;[02]
<a name="l00713"></a>00713     breq    unstuff#c           ;[03]
<a name="l00714"></a>00714     in      phase, USBIN        ;[04] &lt;- phase
<a name="l00715"></a>00715     rjmp    bit@AfterClr        ;[05]
<a name="l00716"></a>00716 unstuff#c:
<a name="l00717"></a>00717     in      phase, USBIN        ;[05] &lt;- phase (one cycle too late)
<a name="l00718"></a>00718     andi    fix, ~(1 &lt;&lt; #)      ;[06]
<a name="l00719"></a>00719     <a class="code" href="usbportability_8h.html#a62df5117c12fbb897e5d6956620d794b">nop2</a>                        ;[-1]
<a name="l00720"></a>00720     <a class="code" href="usbportability_8h.html#a62df5117c12fbb897e5d6956620d794b">nop2</a>                        ;[01]
<a name="l00721"></a>00721 bit#IsSet:
<a name="l00722"></a>00722     ifrclr  phase, USBMINUS     ;[03] check phase only <span class="keywordflow">if</span> D- changed
<a name="l00723"></a>00723     lpm                         ;[04]
<a name="l00724"></a>00724     in      phase, USBIN        ;[05] &lt;- phase (one cycle too late)
<a name="l00725"></a>00725     ori     shift, 1 &lt;&lt; #       ;[06]
<a name="l00726"></a>00726 &lt;?php
<a name="l00727"></a>00727     }
<a name="l00728"></a>00728     <a class="code" href="usbdrvasm128_8inc.html#ac2f992b6aac204db01b43b4fd43463b3">printCmdBuffer</a>($bitNum);
<a name="l00729"></a>00729 }
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 <a class="code" href="usbdrvasm128_8inc.html#a54b8fd7c4098cdf9f73bd9e5f27d41c8">$bitStartCycles</a> = array(1, 9, 17, 26, 34, 42, 51, 59);
<a name="l00732"></a>00732 <span class="keywordflow">for</span>($i = 0; $i &lt; 16; $i++){
<a name="l00733"></a>00733     $bit = $i % 8;
<a name="l00734"></a>00734     $emitClrCode = ($i + (int)($i / 8)) % 2;
<a name="l00735"></a>00735     $cycle = <a class="code" href="usbdrvasm128_8inc.html#a54b8fd7c4098cdf9f73bd9e5f27d41c8">$bitStartCycles</a>[$bit];
<a name="l00736"></a>00736     <span class="keywordflow">if</span>($emitClrCode){
<a name="l00737"></a>00737         printf(<span class="stringliteral">&quot;bit%dAfterClr:\n&quot;</span>, $bit);
<a name="l00738"></a>00738     }<span class="keywordflow">else</span>{
<a name="l00739"></a>00739         printf(<span class="stringliteral">&quot;bit%dAfterSet:\n&quot;</span>, $bit);
<a name="l00740"></a>00740     }
<a name="l00741"></a>00741     ob_start();
<a name="l00742"></a>00742     echo <span class="stringliteral">&quot;    *****                       ;[-1]\n&quot;</span>;
<a name="l00743"></a>00743     <a class="code" href="usbdrvasm128_8inc.html#ac2f992b6aac204db01b43b4fd43463b3">printCmdBuffer</a>($bit);
<a name="l00744"></a>00744     <a class="code" href="usbdrvasm128_8inc.html#aa20c6421372db9ad7677dd98edb28bc4">printBit</a>(!$emitClrCode, $bit);
<a name="l00745"></a>00745     <span class="keywordflow">if</span>($i == 7)
<a name="l00746"></a>00746         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00747"></a>00747 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac2f992b6aac204db01b43b4fd43463b3"></a><!-- doxytag: member="usbdrvasm128.inc::printCmdBuffer" ref="ac2f992b6aac204db01b43b4fd43463b3" args="($thisBit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">printCmdBuffer </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>thisBit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="usbdrvasm128_8inc_source.html#l00665">665</a> of file <a class="el" href="usbdrvasm128_8inc_source.html">usbdrvasm128.inc</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00666"></a>00666 {
<a name="l00667"></a>00667 global $cycle;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669     $nextBit = ($thisBit + 1) % 8;
<a name="l00670"></a>00670     $s = ob_get_contents();
<a name="l00671"></a>00671     ob_end_clean();
<a name="l00672"></a>00672     $s = str_replace(<span class="stringliteral">&quot;#&quot;</span>, $thisBit, $s);
<a name="l00673"></a>00673     $s = str_replace(<span class="stringliteral">&quot;@&quot;</span>, $nextBit, $s);
<a name="l00674"></a>00674     $lines = explode(<span class="stringliteral">&quot;\n&quot;</span>, $s);
<a name="l00675"></a>00675     <span class="keywordflow">for</span>($i = 0; $i &lt; count($lines); $i++){
<a name="l00676"></a>00676         $s = $lines[$i];
<a name="l00677"></a>00677         <span class="keywordflow">if</span>(ereg(<span class="stringliteral">&quot;\\[([0-9-][0-9])\\]&quot;</span>, $s, $regs)){
<a name="l00678"></a>00678             $c = $cycle + (int)$regs[1];
<a name="l00679"></a>00679             $s = ereg_replace(<span class="stringliteral">&quot;\\[[0-9-][0-9]\\]&quot;</span>, sprintf(<span class="stringliteral">&quot;[%02d]&quot;</span>, $c), $s);
<a name="l00680"></a>00680         }
<a name="l00681"></a>00681         <span class="keywordflow">if</span>(strlen($s) &gt; 0)
<a name="l00682"></a>00682             echo <span class="stringliteral">&quot;$s\n&quot;</span>;
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a54b8fd7c4098cdf9f73bd9e5f27d41c8"></a><!-- doxytag: member="usbdrvasm128.inc::$bitStartCycles" ref="a54b8fd7c4098cdf9f73bd9e5f27d41c8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$bitStartCycles = array(1, 9, 17, 26, 34, 42, 51, 59)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="usbdrvasm128_8inc_source.html#l00731">731</a> of file <a class="el" href="usbdrvasm128_8inc_source.html">usbdrvasm128.inc</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>
Generated on Mon Jun 7 18:44:13 2010 for USB IR HID Device by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen.org</a> 1.6.3</small></address>
</body>
</html>
